<?xml version="1.0" encoding="UTF-8"?>
<odoo>

  <record id="seq_failures" model="ir.sequence">
    <field name="name">Failures Sequence</field>
    <field name="code">lgps.failures</field>
    <field name="prefix">RF</field>
    <field name="padding">10</field>
    <field name="company_id" eval="False"/>
  </record>

  <record model="ir.ui.view" id="failures_form_view">
    <field name="name">failures.form</field>
    <field name="model">lgps.failures</field>
    <field name="arch" type="xml">
      <form string="Failures Form">
        <header>
          <field name="state" invisible="True" />
          <field name="stage_id"
                 widget="statusbar"
                 clickable="True"
                 options="{'fold_field': 'fold'}" />
        </header>
        <sheet>
            <div name="button_box" class="oe_button_box">
                        <button class="oe_stat_button"
                    type="action"
                    attrs=""
                    name="%(action_counter_odts_button)d"
                    icon="fa-file-text"
                    context="{'default_failures_id': active_id}">
                <field string="Odts" name="repairs_count" widget="statinfo"/>
            </button>
            </div>

          <group>
            <group string="Failure Information">
              <separator/>
              <field name="product_id"/>
              <field name="client_id"/>
              <field name="symptom"/>
              <field name="failure_functionalities_list_id"/>
              <field name="failure_components_list_id"/>
              <field name="gpsdevice_id"/>
              <field name="accessory_id"/>
            </group>
            <group>
              <separator/>
              <field name="failure_root_problem_list_id"/>
              <field name="name"/>
              <field name="warranty_status"/>
              <field name="report_date"/>
              <field name="serialnumber_id"/>
              <field name="closed_date"/>
            </group>
          </group>
          <notebook>
            <page string="Warranty">
              <group>
                <group string="Warranty Information">
                  <separator/>
                  <field name="warranty_end_date"/>
                  <field name="manipulation_detected" readonly="1"/>
                </group>
              </group>
            </page>

          </notebook>
        </sheet>

        <div class="oe_chatter">
          <field name="message_follower_ids" widget="mail_followers" groups="base.group_user"/>
          <field name="activity_ids" widget="mail_activity"/>
          <field name="message_ids" widget="mail_thread"/>
        </div>
      </form>
    </field>
  </record>

  <record model="ir.ui.view" id="failures_search_view">
    <field name="name">failure.search</field>
    <field name="model">lgps.failures</field>
    <field name="arch" type="xml">
      <search>
        <field name="name"/>
        <field name="client_id"/>
        <field name="product_id"/>
        <field name="gpsdevice_id"/>
      </search>
    </field>
  </record>

  <record model="ir.ui.view" id="failures_tree_view">
    <field name="name">failures.tree</field>
    <field name="model">lgps.failures</field>
    <field name="arch" type="xml">
      <tree string="accessorys Tree">
        <field name="name"/>
        <field name="product_id"/>
        <field name="client_id"/>
        <field name="symptom"/>
        <field name="failure_functionalities_list_id"/>
        <field name="failure_components_list_id"/>
        <field name="failure_root_problem_list_id"/>
        <field name="warranty_status"/>
        <field name="report_date"/>
      </tree>
    </field>
  </record>

<record id="failures_kanban" model="ir.ui.view">
    <field name="model">lgps.failures</field>
    <field name="arch" type="xml">
    <kanban default_group_by="stage_id" class="o_kanban_small_column" group_create="false">
    <!-- Empty for now, but the Kanban will go here! -->
        <!-- Fields (to use in expressions)... -->
        <field name="stage_id" />
        <field name="name" />
        <field name="id" />
        <field name="color" />
        <field name="kanban_state" />
        <field name="message_partner_ids" />
        <field name="report_date"/>
        <field name="product_id" />
        <!-- Optional progress bar -->
        <progressbar
                field="kanban_state"
                colors='{"done": "success", "blocked": "danger"}' />
        <!-- Templates with HTML snippets to use... -->
        <templates>
            <t t-name="kanban-box">
                <!-- HTML QWeb template... -->
                <!-- Set the Kanban Card color: -->
                <div t-attf-class="oe_kanban_color_#{kanban_getcolor(record.color.raw_value)} oe_kanban_global_click">
                    <div class="o_dropdown_kanban dropdown">
                        <!-- Top-right drop down menu here... -->

                        <a class="dropdown-toggle"
                           data-toggle="dropdown" role="button"
                           href="#">
                            <span class="fa fa-ellipsis-v"/>
                        </a>
                        <!--
                        <a class="dropdown-toggle o-no-caret btn" role="button"
                           data-toggle="dropdown"
                           href="#"
                           aria-label="Dropdown menu"
                           title="Dropdown menu">
                            <span class="fa fa-bars fa-lg"/>
                        </a>-->
                        <div class="dropdown-menu" role="menu">
                            <!-- Edit and Delete actions, if available: -->
                            <t t-if="widget.editable"><a type="edit" class="dropdown-item" role="menuitem">Edit</a></t>
                            <t t-if="widget.deletable"><a type="delete" class="dropdown-item" role="menuitem">Delete</a></t>
                            <!-- Color picker option: -->
                            <ul class="oe_kanban_colorpicker" data-field="color"/>
                        </div>
                    </div>
                    <div class="oe_kanban_body">
                        <!-- Content elements and fields go here... -->
                        <div>
                            <strong>
                                <a type="open"><field name="name" /></a>
                            </strong>
                        </div>
                        <div>
                            <field name="product_id" />
                            <br></br>
                            Reporte:&#160;<strong><field name="report_date" /></strong>
                        </div>
                    </div>
                    <div class="oe_kanban_footer">
                        <div class="oe_kanban_footer_left">
                            <!-- Left hand footer... -->
                        </div>

                        <div class="oe_kanban_footer_right">
                            <!-- Right hand footer... -->
                            <div class="float-right">
                                <field name="activity_ids" widget="kanban_activity"/>
                                <field name="kanban_state" widget="kanban_state_selection"/>
                            </div>
                        </div>

                    </div>
                    <div class="oe_clear"/>
                </div> <!-- end of kanban color -->
            </t>
        </templates>
    </kanban>
    </field>
</record>

  <record model="ir.actions.act_window" id="failures_list_action">
    <field name="name">failures</field>
    <field name="res_model">lgps.failures</field>
    <field name="view_type">form</field>
    <field name="view_mode">tree,form,kanban</field>
    <field name="help" type="html">
      <p class="oe_view_nocontent_create">Create the first Failures Record</p>
    </field>
  </record>

    <menuitem id="failures_root_menu" name="Failures Reports" parent="operations_menu"/>
    <menuitem id="failures_menu" name="Failures" parent="failures_root_menu" action="failures_list_action"/>
    <menuitem id="failures_root_conf_menu" name="Configuration" parent="operations_menu"/>
</odoo>
